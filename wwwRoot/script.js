!function(t){function i(n){if(e[n])return e[n].exports;var o=e[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){function n(t){return u.some(function(i){return t instanceof i})}var o=e(1),s=e(2),r=e(3),a=e(4),h=e(5),p=e(6),c=e(7),l=e(8),u=[p,c,l];Math.random=function(){var t=new Uint16Array(1);return function(){return crypto.getRandomValues(t),t[0]/65535}}();var d=h.canvas.width,f=h.canvas.height,y=document.createElement("canvas");y.textContent="y u no browser with canvas support",y.width=d,y.height=f,document.body.appendChild(y);var m=document.createElement("a");m.style.display="block",m.href="#",m.textContent="get screenshot",m.addEventListener("click",function(){this.href=y.toDataURL(),this.download="screenshot.png"}),document.body.appendChild(m);var v=new o(y),g=new s(0);g.on("shoot",function(){S.shoot(g)}),v.addComponent(g);var w=new a(g);w.on("spawn",function(t){v.addComponent(t)}),v.addComponent(w),v.start();var x=h.gameLogic.bulletDistance,b=h.gameLogic.playerDistance,S={on:function(){},score:0,kills:0,enemyCount:0,bullets:0,shoot:function(t){this.bullets++,v.addComponent(new r(t.position,t.direction))},lastSpawn:0,update:function(){var t=v.getComponents(function(t){return t instanceof r}),i=v.getComponents(function(i){return n(i)&&t.some(function(t){t.position.clone().substract(i.position).length();return t.position.clone().substract(i.position).length()<x})});i.length&&(this.kills+=i.length,this.score+=i.map(function(t){return t instanceof l?5:t instanceof c?3:1}).reduce(function(t,i){return t+i},0)*this.kills/this.bullets,i.forEach(function(t){t.emit("dead")}));var e=v.getComponents(function(t){return n(t)&&t.position.clone().substract(g.position).length()<b});e.length>0&&v.stop(),this.enemyCount=v.getComponents(function(t){return n(t)}).length},draw:function(t){t.textAlign="center";var i=this.kills+" kills - shots "+this.bullets;t.font="24pt Consolas",t.fillStyle="rgba(0,0,0, .1)",t.fillText(i,d/2,f/2-220);var e=0|this.score;t.font="172pt Consolas",t.fillStyle="rgba(0,0,0, .25)",t.fillText(e,d/2,f/2-40);var n="efficency: "+(Math.round(100*this.kills/this.bullets)||0)+"%";t.font="32pt Consolas",t.fillStyle="rgba(0,0,0, .15)",t.fillText(n,d/2,f/2+80);var o=this.enemyCount+" enemies detected";t.font="64pt Consolas",t.fillStyle="rgba(0,0,0, .2)",t.fillText(o,d/2,f/2+200)}};v.addComponent(S)},function(t){function i(t){var i=[],e=t.getContext("2d");this.addComponent=function(t){t.on("dead",function(){this.removeComponent(t)}.bind(this)),i.push(t)},this.removeComponent=function(t){var e=i.indexOf(t);t=i.splice(e,1)};var n=0;this.run=function s(r){var a=r-n;n=r,i.forEach(function(t){t.update(a,r)}),e.clearRect(0,0,t.width,t.height),i.forEach(function(t){t.draw&&t.draw(e)}),o&&requestAnimationFrame(s)},this.getComponents=function(t){return i.filter(t)};var o=!1;this.start=function(){o=!0,requestAnimationFrame(this.run)},this.stop=function(){o=!1}}t.exports=i},function(t,i,e){function n(){return navigator.getGamepads&&navigator.getGamepads()||navigator.webkitGetGamepads&&navigator.webkitGetGamepads()}function o(t){s.call(this),this.position=new a(p/2,c/2),this.direction=new a(1,0),this.gamepadIndex=t,this.lastShot=0}var s=e(9),r=e(10),a=e(11),h=e(5),p=h.canvas.width,c=h.canvas.height,l=h.player.size,u=h.player.speed,d=h.player.aimSpeed,f=h.player.shootInterval,y=new Image;y.src="./player.png",r.inherits(o,s),o.prototype.update=function(t,i){var e=n()[this.gamepadIndex];if(e){if(this.aim=e.buttons[6].pressed,.15<e.axes[0]||e.axes[0]<-.15||.15<e.axes[1]||e.axes[1]<-.15){var o=new a(e.axes[0],e.axes[1]).multiply(this.aim?d:u);this.position.add(o)}(.2<e.axes[2]||e.axes[2]<-.2||.2<e.axes[3]||e.axes[3]<-.2)&&(this.angle=Math.atan2(e.axes[3],e.axes[2]),this.direction.x=e.axes[2],this.direction.y=e.axes[3],this.direction.normalize()),e.buttons[7].pressed&&this.canShot(i)&&this.emit("shoot"),this.position.x<l/2&&(this.position.x=l/2),this.position.x>p-l/2&&(this.position.x=p-l/2),this.position.y<l/2&&(this.position.y=l/2),this.position.y>c-l/2&&(this.position.y=c-l/2)}},o.prototype.canShot=function(t){return this.lastShot<t-f?(this.lastShot=t,!0):!1},o.prototype.draw=function(t){t.translate(this.position.x,this.position.y),t.rotate(this.angle),t.drawImage(y,-l/2,-l/2,l,l),t.rotate(-this.angle),t.translate(-this.position.x,-this.position.y),this.aim&&(t.beginPath(),t.moveTo(this.position.x,this.position.y),t.lineTo(this.position.x+1e6*this.direction.x,this.position.y+1e6*this.direction.y),t.strokeStyle="rgba(255,0,0, 0.25)",t.stroke(),t.closePath())},t.exports=o},function(t,i,e){function n(t,i){o.call(this),this.position=t.clone(),this.move=i.clone().multiply(h)}var o=e(9),s=e(10),r=e(5),a=r.rocket.size,h=r.rocket.speed,p=r.rocket.lifetime;s.inherits(n,o),n.prototype.update=function(t,i){this.start||(this.start=i),i-this.start>p?this.emit("dead"):this.position.add(this.move)},n.prototype.draw=function(t){this.explode?(t.beginPath(),t.arc(this.position.x,this.position.y,10,0,2*Math.PI),t.fillStyle="#f00",t.fill(),t.closePath()):(t.fillStyle="#f00",t.fillRect(this.position.x-a/2,this.position.y-a/2,a,a))},t.exports=n},function(t,i,e){function n(t){o.call(this),this.player=t}var o=e(9),s=e(11),r=e(10),a=e(6),h=e(7),p=e(8),c=e(5),l=c.canvas.width,u=c.canvas.height,d=c.spawner.interval,f=c.spawner.minDistance;r.inherits(n,o),n.prototype.lastSpawn=0,n.prototype.update=function(t,i){if(!(this.lastSpawn+d>i)){for(var e=this.player.position.clone();e.clone().substract(this.player.position).length()<f;)e=new s(l*Math.random(),u*Math.random());var n,o=Math.random();n=.1>o?p:o>.8?h:a;var r=new n(this.player,e);this.emit("spawn",r),this.lastSpawn=i}},t.exports=n},function(t){t.exports={canvas:{width:1280,height:720},player:{size:16,speed:2.5,aimSpeed:1,shootInterval:500},rocket:{size:4,speed:5,lifetime:750},follower:{color:{r:0,g:180,b:0},size:16,speed:2,spawnSleep:500},whirrer:{color:{r:0,g:0,b:180},size:16,speed:2,spawnSleep:500,radius:30,rotationSpeed:.01},dasher:{color:{r:180,g:0,b:0},size:16,vMax:12,spawnSleep:500,chargeTime:1e3,dashTime:750,slowdown:.9},spawner:{minDistance:100,interval:750},gameLogic:{bulletDistance:10,playerDistance:16}}},function(t,i,e){function n(t,i){o.call(this),this.player=t,this.position=i}var o=e(9),s=e(10),r=e(5),a=r.follower.size,h=r.follower.speed,p=r.follower.spawnSleep,c=r.follower.color;s.inherits(n,o),n.prototype.update=function(t,i){if(this.spawn||(this.spawn=i),this.active=Math.min((i-this.spawn)/p,1),1===this.active){var e=this.player.position.clone().substract(this.position).normalize();this.position.add(e.multiply(h))}},n.prototype.draw=function(t){t.fillStyle=s.getRGBA(c,this.active||0),t.fillRect(this.position.x-a/2,this.position.y-a/2,a,a)},t.exports=n},function(t,i,e){function n(t,i){o.call(this),this.player=t,this.position=i}var o=e(9),s=e(11),r=e(10),a=e(5),h=a.dasher.size,p=a.dasher.vMax,c=a.dasher.spawnSleep,l=a.dasher.color,u=a.dasher.chargeTime,d=a.dasher.dashTime,f=a.dasher.slowdown,y=1,m=2;r.inherits(n,o),n.prototype.update=function(t,i){this.spawn||(this.spawn=i),this.active=Math.min((i-this.spawn)/c,1);var e=(i-this.spawn)%(u+d),n=u>e?y:m;if(n!==this.state)switch(n){case y:this.velocity=s.zero;break;case m:this.velocity=this.player.position.clone().substract(this.position).normalize().multiply(p)}switch(this.state=n,this.state){case y:this.colorFactor=.2+.8*e/d;break;case m:this.colorFactor=1-.8*e/(u+d)}1===this.active&&this.position.add(this.velocity.multiply(f))},n.prototype.draw=function(t){var i=r.getRGBA(Math.round(l.r*this.colorFactor),Math.round(l.g*this.colorFactor),Math.round(l.b*this.colorFactor),this.active||0);t.fillStyle=i,t.fillRect(this.position.x-h/2,this.position.y-h/2,h,h)},t.exports=n},function(t,i,e){function n(t,i){o.call(this),this.player=t,this.basePosition=i;var e=this.basePosition.clone().substract(this.player.position).normalize().multiply(u);this.rotation=1,this.position=this.basePosition.add(e)}var o=e(9),s=e(10),r=e(11),a=e(5),h=a.whirrer.size,p=a.whirrer.speed,c=a.whirrer.spawnSleep,l=a.whirrer.color,u=a.whirrer.radius,d=a.whirrer.rotationSpeed;s.inherits(n,o),n.prototype.update=function(t,i){if(this.spawn||(this.spawn=i),this.active=Math.min((i-this.spawn)/c,1),1===this.active){var e=this.player.position.clone().substract(this.position).normalize();this.basePosition.add(e.multiply(p)),this.rotation=(i-this.spawn)*d;var n=new r(Math.sin(this.rotation),Math.cos(this.rotation)).multiply(u);this.position=this.basePosition.clone().add(n)}},n.prototype.draw=function(t){t.fillStyle=s.getRGBA(l,this.active||0),t.fillRect(this.position.x-h/2,this.position.y-h/2,h,h)},t.exports=n},function(t){function i(){this.events={}}i.prototype.addEventListener=function(t,i){t=String(t).toLowerCase(),this.events[t]=this.events[t]||[],this.events[t].push(i)},i.prototype.on=i.prototype.addEventListener,i.prototype.removeEventListener=function(t,i){t=String(t).toLowerCase();var e=this.events[t]||[],n=e.indexOf(i);return-1===n?!1:(e.splice(n,1),!0)},i.prototype.un=i.prototype.removeEventListener,i.prototype.off=i.prototype.removeEventListener,i.prototype.fireEvent=function(t){t=String(t).toLowerCase();var i=[].slice.call(arguments,1),e=(this.events[t]||[]).slice();e.forEach(function(t){t.apply(this,i)},this)},i.prototype.emit=i.prototype.fireEvent,i.prototype.once=function(t,i){t=String(t).toLowerCase();var e=function(){this.un(t,e),i.apply(this,arguments)}.bind(this);this.on(t,e)},t.exports=i},function(t){t.exports={inherits:function(t,i){t.prototype=Object.create(i.prototype,{constructor:{value:t,writeable:!0,configurable:!0}})},getRGBA:function(){var t,i;return"object"==typeof arguments[0]?(t=arguments[0],i=arguments[1]):(t={r:arguments[0],b:arguments[1],g:arguments[2]},i=arguments[3]),["rgba(",t.r||0,",",t.g||0,",",t.b||0,",",i,")"].join("")}}},function(t){function i(t,i){"undefined"==typeof i&&(i=t),this.x=t,this.y=i}i.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},i.prototype.distance=function(t){return Math.sqrt(this.distanceSquared(t))},i.prototype.distanceSquared=function(t){return this.substract(t).lengthSquared()},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y},i.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},i.prototype.length=function(){return Math.sqrt(this.lengthSquared())},i.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},i.prototype.max=function(t){return new i(this.x>t.x?this.x:t.x,this.y>t.y?this.y:t.y)},i.prototype.min=function(t){return new i(this.x<t.x?this.x:t.x,this.y<t.y?this.y:t.y)},i.prototype.multiply=function(t){return"number"==typeof t?(this.x*=t,this.y*=t):(this.x+=t.x,this.y+=t.y),this},i.prototype.negate=function(){return this.x*=-1,this.y*=-1,this},i.prototype.normalize=function(){var t=this.length();return this.x/=t,this.y/=t,this},i.prototype.substract=function(t){return this.add(t.clone().multiply(-1)),this},i.prototype.clone=function(){return new i(this.x,this.y)},Object.defineProperties(i,{one:{get:function(){return new i(1,1)}},zero:{get:function(){return new i(0,0)}},unitX:{get:function(){return new i(1,0)}},unitY:{get:function(){return new i(0,1)}}}),t.exports=i}]);